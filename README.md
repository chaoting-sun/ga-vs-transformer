# Molecular Design: Transformer vs. Genetic Algorithm

In this project, we evaluated and compared the optimization of molecules generated by trained Transformers and Genetic Algorithms. The goal was to optimize the particient coefficient (logP) of the starting molecules.

To assess the optimization, we first observed several properties, including logP and other chemical characteristics such as tPSA, QED, SAS, NP, MW, and NATOM. The ideal outcome was for the particient coefficient to be close to the desired value while other properties remained unchanged. Secondly, we calculated validity, uniqueness, novelty, and internal diversity statistics to evaluate the ability of the methods to explore the chemical space.

To see more updated information, please check out [ga-vs-transformer]()

## Methods
We conducted experiments with three types of genetic algorithms: **samegen-MC**, **Roulette**, and **parent-child-MC**. The initial population consisted of 40 molecules, which were evolved over 500 generations. We also trained a Transformer model using a training set of 160831 matched molecular pairs (MMPs) and used it to optimize 100 molecules. The model received the starting molecule and delta property as inputs and generated its predictions as outputs. We evaluated the optimization process with multiple steps, including four variations: **tf-1step**, **tf-2step**, **tf-3step**, **tf-4step**.

Each of the genetic algorithm types was run four times, while the Transformer was trained five times and generated predictions independently for each variation.

## Property Metrics
Initially, we calculate the logP (partition coefficient) to assess the quality of the optimized molecules. Furthermore, errors related to MSD, MAD, MAX, MIN, and fluctuations SD are also calculated. Secondly, we compute several other properties to compare the distribution differences between the source and the predictions, including **tPSA**, **QED**, **SAS**, **NP**, **MW**, and **NATOM**.

The logP calculation is performed using openbabel, while all the other properties are calculated using rdkit.

- tPSA (topological polar surface area): value > 0
- QED (quantitative estimation of drug-likeness): 1 > value > 0
- SAS (synthetic accessibility score): 10 > value > 0
- NP (natural product-likeness score): 5 > value > -5
- MW (molecular weight): value > 0
- NATOM (number of heavy atoms):  value > 0

## Feasibility/Diversity Metrics
The mean and mode of the properties of the predicted molecules are computed to observe the property shift. Additionally, **validity**, **uniqueness**, **novelty**, and **internal diversity** are calculated to assess the diversity and quality of the optimized molecules.

- validity: chemical feasibility check on SMILES. To simplify the problem, a SMILES is valid if it can be converted into a mol object by both rdkit and openbabel.
- uniqueness: the fraction of unique molecules to the valid molecules
- novelty: The fraction of molecules that are not seen by the algorithms/models is calculated. For the genetic algorithm, the generated molecules are compared to the initial population, while for the Transformer, the generated molecules are compared to the training set.
- internal diversity: the chemical diversity of the generated molecules, which is between 0 and 1.

## File Description
- Data
    - ga-src.csv: the starting molecules for Genetic Algorithms
    - tf-src.csv: the starting molecules for Transformers
    - tr-train.csv: the training set for Transformers
- Results
    - Gen: the generated molecules
    - Prop: the properties of the generated molecules
    - Stat: some metrics
    - Figure: figure of property distribution